{
  "hash": "6b799fb1dc7c0a7850d95b79fe5e7097",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Alluvial plots for transition analysis\"\ndescription: |\n    Generating transition plots in R with `ggalluvial`\ndate: \"2024-07-22\"\ncategories:\n  - R\n  - visualization\n  - tutorial\n# engine: markdown\ncode-fold: false\nwarning: false\nmessage: false\nfig.align: center\n---\n\n::: {.cell}\n\n:::\n\n\n\n\nRecently, one of my collaborators asked me for the code that I used to generate one of the plots (Fig. 3) in our joined paper:\n\nMohammed Saqr, Sonsoles LÃ³pez-Pernas, Leonie V.D.E. Vogelsmeier, When, how and for whom changes in engagement happen: A transition analysis of instructional variables, *Computers & Education*, Volume 207, 2023, 104934, [https://doi.org/10.1016/j.compedu.2023.104934](https://doi.org/10.1016/j.compedu.2023.104934).\n\n\nI decided to share it in case it is useful for someone else.\n\nThe first step, as usual, is to load the necessary libraries. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(ggalluvial)\n```\n:::\n\n\n\nThen we need some data. We will create a synthetic dataset for the purpose of this tutorial. We will create four possible states (`states`) and the probability to be in each state (`probs`), as well as define the number of simulated students (`N`). We will create a function that generates a random state based on the established probability distribution. We will then generate random states for all users across 6 time points following that probability distribution. We do that within a new dataframe where the user column represents the user number (between 1 and 30 in our case), the six following columns are each of the six time points, and the last column (`Freq`) holds the value `1` for every student (we will need this for the next step).\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSTATES <- c(\"Active\", \"Moderate\", \"Disengaged\", \"Dropout\")\nPROBS <- c(0.1, 0.65, 0.25, 0.2)\nN <- 30\n\ngetRandom <- function(states = STATES, probs = PROBS, N = 30) {\n  factor(base::sample(states, 30, replace = TRUE, prob = probs), levels = states)\n}\n\nsample_data = data.frame(user=1:N,\n                         `1` =  getRandom(),\n                         `2` =  getRandom(),\n                         `3` =  getRandom(),\n                         `4` =  getRandom(),\n                         `5` =  getRandom(),\n                         `6` =  getRandom(),\n                         Freq = rep(1,N))\n\nsample_data\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"user\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"X1\"],\"name\":[2],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"X2\"],\"name\":[3],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"X3\"],\"name\":[4],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"X4\"],\"name\":[5],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"X5\"],\"name\":[6],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"X6\"],\"name\":[7],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"Freq\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"Moderate\",\"3\":\"Moderate\",\"4\":\"Moderate\",\"5\":\"Disengaged\",\"6\":\"Moderate\",\"7\":\"Dropout\",\"8\":\"1\"},{\"1\":\"2\",\"2\":\"Moderate\",\"3\":\"Active\",\"4\":\"Moderate\",\"5\":\"Moderate\",\"6\":\"Moderate\",\"7\":\"Moderate\",\"8\":\"1\"},{\"1\":\"3\",\"2\":\"Moderate\",\"3\":\"Disengaged\",\"4\":\"Moderate\",\"5\":\"Disengaged\",\"6\":\"Moderate\",\"7\":\"Moderate\",\"8\":\"1\"},{\"1\":\"4\",\"2\":\"Moderate\",\"3\":\"Dropout\",\"4\":\"Disengaged\",\"5\":\"Dropout\",\"6\":\"Moderate\",\"7\":\"Dropout\",\"8\":\"1\"},{\"1\":\"5\",\"2\":\"Dropout\",\"3\":\"Moderate\",\"4\":\"Moderate\",\"5\":\"Dropout\",\"6\":\"Moderate\",\"7\":\"Moderate\",\"8\":\"1\"},{\"1\":\"6\",\"2\":\"Moderate\",\"3\":\"Moderate\",\"4\":\"Moderate\",\"5\":\"Moderate\",\"6\":\"Moderate\",\"7\":\"Moderate\",\"8\":\"1\"},{\"1\":\"7\",\"2\":\"Moderate\",\"3\":\"Moderate\",\"4\":\"Disengaged\",\"5\":\"Active\",\"6\":\"Dropout\",\"7\":\"Dropout\",\"8\":\"1\"},{\"1\":\"8\",\"2\":\"Moderate\",\"3\":\"Disengaged\",\"4\":\"Disengaged\",\"5\":\"Moderate\",\"6\":\"Moderate\",\"7\":\"Active\",\"8\":\"1\"},{\"1\":\"9\",\"2\":\"Disengaged\",\"3\":\"Moderate\",\"4\":\"Moderate\",\"5\":\"Moderate\",\"6\":\"Moderate\",\"7\":\"Moderate\",\"8\":\"1\"},{\"1\":\"10\",\"2\":\"Disengaged\",\"3\":\"Moderate\",\"4\":\"Active\",\"5\":\"Dropout\",\"6\":\"Disengaged\",\"7\":\"Moderate\",\"8\":\"1\"},{\"1\":\"11\",\"2\":\"Moderate\",\"3\":\"Disengaged\",\"4\":\"Moderate\",\"5\":\"Disengaged\",\"6\":\"Active\",\"7\":\"Moderate\",\"8\":\"1\"},{\"1\":\"12\",\"2\":\"Moderate\",\"3\":\"Moderate\",\"4\":\"Disengaged\",\"5\":\"Dropout\",\"6\":\"Dropout\",\"7\":\"Moderate\",\"8\":\"1\"},{\"1\":\"13\",\"2\":\"Moderate\",\"3\":\"Moderate\",\"4\":\"Moderate\",\"5\":\"Moderate\",\"6\":\"Dropout\",\"7\":\"Moderate\",\"8\":\"1\"},{\"1\":\"14\",\"2\":\"Active\",\"3\":\"Disengaged\",\"4\":\"Moderate\",\"5\":\"Active\",\"6\":\"Dropout\",\"7\":\"Moderate\",\"8\":\"1\"},{\"1\":\"15\",\"2\":\"Dropout\",\"3\":\"Moderate\",\"4\":\"Moderate\",\"5\":\"Moderate\",\"6\":\"Moderate\",\"7\":\"Moderate\",\"8\":\"1\"},{\"1\":\"16\",\"2\":\"Moderate\",\"3\":\"Disengaged\",\"4\":\"Dropout\",\"5\":\"Moderate\",\"6\":\"Moderate\",\"7\":\"Moderate\",\"8\":\"1\"},{\"1\":\"17\",\"2\":\"Moderate\",\"3\":\"Dropout\",\"4\":\"Disengaged\",\"5\":\"Dropout\",\"6\":\"Moderate\",\"7\":\"Moderate\",\"8\":\"1\"},{\"1\":\"18\",\"2\":\"Moderate\",\"3\":\"Moderate\",\"4\":\"Moderate\",\"5\":\"Moderate\",\"6\":\"Moderate\",\"7\":\"Active\",\"8\":\"1\"},{\"1\":\"19\",\"2\":\"Disengaged\",\"3\":\"Moderate\",\"4\":\"Dropout\",\"5\":\"Moderate\",\"6\":\"Moderate\",\"7\":\"Moderate\",\"8\":\"1\"},{\"1\":\"20\",\"2\":\"Dropout\",\"3\":\"Dropout\",\"4\":\"Disengaged\",\"5\":\"Moderate\",\"6\":\"Moderate\",\"7\":\"Disengaged\",\"8\":\"1\"},{\"1\":\"21\",\"2\":\"Dropout\",\"3\":\"Disengaged\",\"4\":\"Moderate\",\"5\":\"Moderate\",\"6\":\"Moderate\",\"7\":\"Moderate\",\"8\":\"1\"},{\"1\":\"22\",\"2\":\"Moderate\",\"3\":\"Moderate\",\"4\":\"Dropout\",\"5\":\"Active\",\"6\":\"Moderate\",\"7\":\"Moderate\",\"8\":\"1\"},{\"1\":\"23\",\"2\":\"Moderate\",\"3\":\"Moderate\",\"4\":\"Moderate\",\"5\":\"Moderate\",\"6\":\"Moderate\",\"7\":\"Disengaged\",\"8\":\"1\"},{\"1\":\"24\",\"2\":\"Moderate\",\"3\":\"Disengaged\",\"4\":\"Moderate\",\"5\":\"Active\",\"6\":\"Moderate\",\"7\":\"Disengaged\",\"8\":\"1\"},{\"1\":\"25\",\"2\":\"Disengaged\",\"3\":\"Moderate\",\"4\":\"Moderate\",\"5\":\"Moderate\",\"6\":\"Moderate\",\"7\":\"Moderate\",\"8\":\"1\"},{\"1\":\"26\",\"2\":\"Moderate\",\"3\":\"Moderate\",\"4\":\"Moderate\",\"5\":\"Moderate\",\"6\":\"Dropout\",\"7\":\"Moderate\",\"8\":\"1\"},{\"1\":\"27\",\"2\":\"Moderate\",\"3\":\"Dropout\",\"4\":\"Dropout\",\"5\":\"Moderate\",\"6\":\"Moderate\",\"7\":\"Moderate\",\"8\":\"1\"},{\"1\":\"28\",\"2\":\"Disengaged\",\"3\":\"Disengaged\",\"4\":\"Disengaged\",\"5\":\"Moderate\",\"6\":\"Moderate\",\"7\":\"Moderate\",\"8\":\"1\"},{\"1\":\"29\",\"2\":\"Disengaged\",\"3\":\"Moderate\",\"4\":\"Moderate\",\"5\":\"Moderate\",\"6\":\"Disengaged\",\"7\":\"Disengaged\",\"8\":\"1\"},{\"1\":\"30\",\"2\":\"Moderate\",\"3\":\"Moderate\",\"4\":\"Moderate\",\"5\":\"Moderate\",\"6\":\"Moderate\",\"7\":\"Dropout\",\"8\":\"1\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\nNow we transform the data into a format suitable for alluvial plotting using the `to_lodes_form` function. We input the previous dataset as the first argument to the function and we provide the range of columns that hold the timepoints as the `axes` argument. We then need to add make transformations, such as adding the count of each state per timepoint (`Total`) and calculating the proportion (`Prop`).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlodes <- to_lodes_form(sample_data, axes = 2:7) # From 1 to 6\nlodesclean <- lodes |> \n  group_by(x) |>\n  add_count(Freq, name = \"Total\") |> \n  ungroup() |> \n  transform(Prop = Freq/Total)\n\nlodesclean\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"user\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Freq\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"alluvium\"],\"name\":[3],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"x\"],\"name\":[4],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"stratum\"],\"name\":[5],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"Total\"],\"name\":[6],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Prop\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"1\",\"3\":\"1\",\"4\":\"X1\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"2\",\"4\":\"X1\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"3\",\"4\":\"X1\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"4\",\"2\":\"1\",\"3\":\"4\",\"4\":\"X1\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"5\",\"2\":\"1\",\"3\":\"5\",\"4\":\"X1\",\"5\":\"Dropout\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"6\",\"2\":\"1\",\"3\":\"6\",\"4\":\"X1\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"7\",\"2\":\"1\",\"3\":\"7\",\"4\":\"X1\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"8\",\"2\":\"1\",\"3\":\"8\",\"4\":\"X1\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"9\",\"2\":\"1\",\"3\":\"9\",\"4\":\"X1\",\"5\":\"Disengaged\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"10\",\"2\":\"1\",\"3\":\"10\",\"4\":\"X1\",\"5\":\"Disengaged\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"11\",\"2\":\"1\",\"3\":\"11\",\"4\":\"X1\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"12\",\"2\":\"1\",\"3\":\"12\",\"4\":\"X1\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"13\",\"2\":\"1\",\"3\":\"13\",\"4\":\"X1\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"14\",\"2\":\"1\",\"3\":\"14\",\"4\":\"X1\",\"5\":\"Active\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"15\",\"2\":\"1\",\"3\":\"15\",\"4\":\"X1\",\"5\":\"Dropout\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"16\",\"2\":\"1\",\"3\":\"16\",\"4\":\"X1\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"17\",\"2\":\"1\",\"3\":\"17\",\"4\":\"X1\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"18\",\"2\":\"1\",\"3\":\"18\",\"4\":\"X1\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"19\",\"2\":\"1\",\"3\":\"19\",\"4\":\"X1\",\"5\":\"Disengaged\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"20\",\"2\":\"1\",\"3\":\"20\",\"4\":\"X1\",\"5\":\"Dropout\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"21\",\"2\":\"1\",\"3\":\"21\",\"4\":\"X1\",\"5\":\"Dropout\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"22\",\"2\":\"1\",\"3\":\"22\",\"4\":\"X1\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"23\",\"2\":\"1\",\"3\":\"23\",\"4\":\"X1\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"24\",\"2\":\"1\",\"3\":\"24\",\"4\":\"X1\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"25\",\"2\":\"1\",\"3\":\"25\",\"4\":\"X1\",\"5\":\"Disengaged\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"26\",\"2\":\"1\",\"3\":\"26\",\"4\":\"X1\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"27\",\"2\":\"1\",\"3\":\"27\",\"4\":\"X1\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"28\",\"2\":\"1\",\"3\":\"28\",\"4\":\"X1\",\"5\":\"Disengaged\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"29\",\"2\":\"1\",\"3\":\"29\",\"4\":\"X1\",\"5\":\"Disengaged\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"30\",\"2\":\"1\",\"3\":\"30\",\"4\":\"X1\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"1\",\"4\":\"X2\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"2\",\"4\":\"X2\",\"5\":\"Active\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"3\",\"4\":\"X2\",\"5\":\"Disengaged\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"4\",\"2\":\"1\",\"3\":\"4\",\"4\":\"X2\",\"5\":\"Dropout\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"5\",\"2\":\"1\",\"3\":\"5\",\"4\":\"X2\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"6\",\"2\":\"1\",\"3\":\"6\",\"4\":\"X2\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"7\",\"2\":\"1\",\"3\":\"7\",\"4\":\"X2\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"8\",\"2\":\"1\",\"3\":\"8\",\"4\":\"X2\",\"5\":\"Disengaged\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"9\",\"2\":\"1\",\"3\":\"9\",\"4\":\"X2\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"10\",\"2\":\"1\",\"3\":\"10\",\"4\":\"X2\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"11\",\"2\":\"1\",\"3\":\"11\",\"4\":\"X2\",\"5\":\"Disengaged\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"12\",\"2\":\"1\",\"3\":\"12\",\"4\":\"X2\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"13\",\"2\":\"1\",\"3\":\"13\",\"4\":\"X2\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"14\",\"2\":\"1\",\"3\":\"14\",\"4\":\"X2\",\"5\":\"Disengaged\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"15\",\"2\":\"1\",\"3\":\"15\",\"4\":\"X2\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"16\",\"2\":\"1\",\"3\":\"16\",\"4\":\"X2\",\"5\":\"Disengaged\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"17\",\"2\":\"1\",\"3\":\"17\",\"4\":\"X2\",\"5\":\"Dropout\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"18\",\"2\":\"1\",\"3\":\"18\",\"4\":\"X2\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"19\",\"2\":\"1\",\"3\":\"19\",\"4\":\"X2\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"20\",\"2\":\"1\",\"3\":\"20\",\"4\":\"X2\",\"5\":\"Dropout\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"21\",\"2\":\"1\",\"3\":\"21\",\"4\":\"X2\",\"5\":\"Disengaged\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"22\",\"2\":\"1\",\"3\":\"22\",\"4\":\"X2\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"23\",\"2\":\"1\",\"3\":\"23\",\"4\":\"X2\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"24\",\"2\":\"1\",\"3\":\"24\",\"4\":\"X2\",\"5\":\"Disengaged\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"25\",\"2\":\"1\",\"3\":\"25\",\"4\":\"X2\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"26\",\"2\":\"1\",\"3\":\"26\",\"4\":\"X2\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"27\",\"2\":\"1\",\"3\":\"27\",\"4\":\"X2\",\"5\":\"Dropout\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"28\",\"2\":\"1\",\"3\":\"28\",\"4\":\"X2\",\"5\":\"Disengaged\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"29\",\"2\":\"1\",\"3\":\"29\",\"4\":\"X2\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"30\",\"2\":\"1\",\"3\":\"30\",\"4\":\"X2\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"1\",\"4\":\"X3\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"2\",\"4\":\"X3\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"3\",\"4\":\"X3\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"4\",\"2\":\"1\",\"3\":\"4\",\"4\":\"X3\",\"5\":\"Disengaged\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"5\",\"2\":\"1\",\"3\":\"5\",\"4\":\"X3\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"6\",\"2\":\"1\",\"3\":\"6\",\"4\":\"X3\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"7\",\"2\":\"1\",\"3\":\"7\",\"4\":\"X3\",\"5\":\"Disengaged\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"8\",\"2\":\"1\",\"3\":\"8\",\"4\":\"X3\",\"5\":\"Disengaged\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"9\",\"2\":\"1\",\"3\":\"9\",\"4\":\"X3\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"10\",\"2\":\"1\",\"3\":\"10\",\"4\":\"X3\",\"5\":\"Active\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"11\",\"2\":\"1\",\"3\":\"11\",\"4\":\"X3\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"12\",\"2\":\"1\",\"3\":\"12\",\"4\":\"X3\",\"5\":\"Disengaged\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"13\",\"2\":\"1\",\"3\":\"13\",\"4\":\"X3\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"14\",\"2\":\"1\",\"3\":\"14\",\"4\":\"X3\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"15\",\"2\":\"1\",\"3\":\"15\",\"4\":\"X3\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"16\",\"2\":\"1\",\"3\":\"16\",\"4\":\"X3\",\"5\":\"Dropout\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"17\",\"2\":\"1\",\"3\":\"17\",\"4\":\"X3\",\"5\":\"Disengaged\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"18\",\"2\":\"1\",\"3\":\"18\",\"4\":\"X3\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"19\",\"2\":\"1\",\"3\":\"19\",\"4\":\"X3\",\"5\":\"Dropout\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"20\",\"2\":\"1\",\"3\":\"20\",\"4\":\"X3\",\"5\":\"Disengaged\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"21\",\"2\":\"1\",\"3\":\"21\",\"4\":\"X3\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"22\",\"2\":\"1\",\"3\":\"22\",\"4\":\"X3\",\"5\":\"Dropout\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"23\",\"2\":\"1\",\"3\":\"23\",\"4\":\"X3\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"24\",\"2\":\"1\",\"3\":\"24\",\"4\":\"X3\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"25\",\"2\":\"1\",\"3\":\"25\",\"4\":\"X3\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"26\",\"2\":\"1\",\"3\":\"26\",\"4\":\"X3\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"27\",\"2\":\"1\",\"3\":\"27\",\"4\":\"X3\",\"5\":\"Dropout\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"28\",\"2\":\"1\",\"3\":\"28\",\"4\":\"X3\",\"5\":\"Disengaged\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"29\",\"2\":\"1\",\"3\":\"29\",\"4\":\"X3\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"30\",\"2\":\"1\",\"3\":\"30\",\"4\":\"X3\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"1\",\"4\":\"X4\",\"5\":\"Disengaged\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"2\",\"4\":\"X4\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"3\",\"4\":\"X4\",\"5\":\"Disengaged\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"4\",\"2\":\"1\",\"3\":\"4\",\"4\":\"X4\",\"5\":\"Dropout\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"5\",\"2\":\"1\",\"3\":\"5\",\"4\":\"X4\",\"5\":\"Dropout\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"6\",\"2\":\"1\",\"3\":\"6\",\"4\":\"X4\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"7\",\"2\":\"1\",\"3\":\"7\",\"4\":\"X4\",\"5\":\"Active\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"8\",\"2\":\"1\",\"3\":\"8\",\"4\":\"X4\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"9\",\"2\":\"1\",\"3\":\"9\",\"4\":\"X4\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"10\",\"2\":\"1\",\"3\":\"10\",\"4\":\"X4\",\"5\":\"Dropout\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"11\",\"2\":\"1\",\"3\":\"11\",\"4\":\"X4\",\"5\":\"Disengaged\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"12\",\"2\":\"1\",\"3\":\"12\",\"4\":\"X4\",\"5\":\"Dropout\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"13\",\"2\":\"1\",\"3\":\"13\",\"4\":\"X4\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"14\",\"2\":\"1\",\"3\":\"14\",\"4\":\"X4\",\"5\":\"Active\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"15\",\"2\":\"1\",\"3\":\"15\",\"4\":\"X4\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"16\",\"2\":\"1\",\"3\":\"16\",\"4\":\"X4\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"17\",\"2\":\"1\",\"3\":\"17\",\"4\":\"X4\",\"5\":\"Dropout\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"18\",\"2\":\"1\",\"3\":\"18\",\"4\":\"X4\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"19\",\"2\":\"1\",\"3\":\"19\",\"4\":\"X4\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"20\",\"2\":\"1\",\"3\":\"20\",\"4\":\"X4\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"21\",\"2\":\"1\",\"3\":\"21\",\"4\":\"X4\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"22\",\"2\":\"1\",\"3\":\"22\",\"4\":\"X4\",\"5\":\"Active\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"23\",\"2\":\"1\",\"3\":\"23\",\"4\":\"X4\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"24\",\"2\":\"1\",\"3\":\"24\",\"4\":\"X4\",\"5\":\"Active\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"25\",\"2\":\"1\",\"3\":\"25\",\"4\":\"X4\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"26\",\"2\":\"1\",\"3\":\"26\",\"4\":\"X4\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"27\",\"2\":\"1\",\"3\":\"27\",\"4\":\"X4\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"28\",\"2\":\"1\",\"3\":\"28\",\"4\":\"X4\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"29\",\"2\":\"1\",\"3\":\"29\",\"4\":\"X4\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"30\",\"2\":\"1\",\"3\":\"30\",\"4\":\"X4\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"1\",\"4\":\"X5\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"2\",\"4\":\"X5\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"3\",\"4\":\"X5\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"4\",\"2\":\"1\",\"3\":\"4\",\"4\":\"X5\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"5\",\"2\":\"1\",\"3\":\"5\",\"4\":\"X5\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"6\",\"2\":\"1\",\"3\":\"6\",\"4\":\"X5\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"7\",\"2\":\"1\",\"3\":\"7\",\"4\":\"X5\",\"5\":\"Dropout\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"8\",\"2\":\"1\",\"3\":\"8\",\"4\":\"X5\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"9\",\"2\":\"1\",\"3\":\"9\",\"4\":\"X5\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"10\",\"2\":\"1\",\"3\":\"10\",\"4\":\"X5\",\"5\":\"Disengaged\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"11\",\"2\":\"1\",\"3\":\"11\",\"4\":\"X5\",\"5\":\"Active\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"12\",\"2\":\"1\",\"3\":\"12\",\"4\":\"X5\",\"5\":\"Dropout\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"13\",\"2\":\"1\",\"3\":\"13\",\"4\":\"X5\",\"5\":\"Dropout\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"14\",\"2\":\"1\",\"3\":\"14\",\"4\":\"X5\",\"5\":\"Dropout\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"15\",\"2\":\"1\",\"3\":\"15\",\"4\":\"X5\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"16\",\"2\":\"1\",\"3\":\"16\",\"4\":\"X5\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"17\",\"2\":\"1\",\"3\":\"17\",\"4\":\"X5\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"18\",\"2\":\"1\",\"3\":\"18\",\"4\":\"X5\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"19\",\"2\":\"1\",\"3\":\"19\",\"4\":\"X5\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"20\",\"2\":\"1\",\"3\":\"20\",\"4\":\"X5\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"21\",\"2\":\"1\",\"3\":\"21\",\"4\":\"X5\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"22\",\"2\":\"1\",\"3\":\"22\",\"4\":\"X5\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"23\",\"2\":\"1\",\"3\":\"23\",\"4\":\"X5\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"24\",\"2\":\"1\",\"3\":\"24\",\"4\":\"X5\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"25\",\"2\":\"1\",\"3\":\"25\",\"4\":\"X5\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"26\",\"2\":\"1\",\"3\":\"26\",\"4\":\"X5\",\"5\":\"Dropout\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"27\",\"2\":\"1\",\"3\":\"27\",\"4\":\"X5\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"28\",\"2\":\"1\",\"3\":\"28\",\"4\":\"X5\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"29\",\"2\":\"1\",\"3\":\"29\",\"4\":\"X5\",\"5\":\"Disengaged\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"30\",\"2\":\"1\",\"3\":\"30\",\"4\":\"X5\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"1\",\"4\":\"X6\",\"5\":\"Dropout\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"2\",\"4\":\"X6\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"3\",\"4\":\"X6\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"4\",\"2\":\"1\",\"3\":\"4\",\"4\":\"X6\",\"5\":\"Dropout\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"5\",\"2\":\"1\",\"3\":\"5\",\"4\":\"X6\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"6\",\"2\":\"1\",\"3\":\"6\",\"4\":\"X6\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"7\",\"2\":\"1\",\"3\":\"7\",\"4\":\"X6\",\"5\":\"Dropout\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"8\",\"2\":\"1\",\"3\":\"8\",\"4\":\"X6\",\"5\":\"Active\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"9\",\"2\":\"1\",\"3\":\"9\",\"4\":\"X6\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"10\",\"2\":\"1\",\"3\":\"10\",\"4\":\"X6\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"11\",\"2\":\"1\",\"3\":\"11\",\"4\":\"X6\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"12\",\"2\":\"1\",\"3\":\"12\",\"4\":\"X6\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"13\",\"2\":\"1\",\"3\":\"13\",\"4\":\"X6\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"14\",\"2\":\"1\",\"3\":\"14\",\"4\":\"X6\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"15\",\"2\":\"1\",\"3\":\"15\",\"4\":\"X6\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"16\",\"2\":\"1\",\"3\":\"16\",\"4\":\"X6\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"17\",\"2\":\"1\",\"3\":\"17\",\"4\":\"X6\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"18\",\"2\":\"1\",\"3\":\"18\",\"4\":\"X6\",\"5\":\"Active\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"19\",\"2\":\"1\",\"3\":\"19\",\"4\":\"X6\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"20\",\"2\":\"1\",\"3\":\"20\",\"4\":\"X6\",\"5\":\"Disengaged\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"21\",\"2\":\"1\",\"3\":\"21\",\"4\":\"X6\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"22\",\"2\":\"1\",\"3\":\"22\",\"4\":\"X6\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"23\",\"2\":\"1\",\"3\":\"23\",\"4\":\"X6\",\"5\":\"Disengaged\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"24\",\"2\":\"1\",\"3\":\"24\",\"4\":\"X6\",\"5\":\"Disengaged\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"25\",\"2\":\"1\",\"3\":\"25\",\"4\":\"X6\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"26\",\"2\":\"1\",\"3\":\"26\",\"4\":\"X6\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"27\",\"2\":\"1\",\"3\":\"27\",\"4\":\"X6\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"28\",\"2\":\"1\",\"3\":\"28\",\"4\":\"X6\",\"5\":\"Moderate\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"29\",\"2\":\"1\",\"3\":\"29\",\"4\":\"X6\",\"5\":\"Disengaged\",\"6\":\"30\",\"7\":\"0.03333333\"},{\"1\":\"30\",\"2\":\"1\",\"3\":\"30\",\"4\":\"X6\",\"5\":\"Dropout\",\"6\":\"30\",\"7\":\"0.03333333\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n \nNow, we move on to the plotting part. We provide the `lodesclean` dataset as an input and specify the column containing the time point (by default `x`) as the x-axis variable. We do the same for `stratum` and `alluvium`. Additionally, we use the `Prop` column as y-axis variable and we color (`fill`) by stratum. Then we specify the necessary geometries. The first one (`geom_flow`), takes care of the transition flows between the time points. We can adjust the `width` parameter, the curvature (`curve_type`), the transparency (`alpha`), among other parameters. Next is `geom_stratum`, which takes care of drawing the bar plots that represent the states at each time point. We can customize the `width` again and the font `color`, among others. Then, we can add labels for both the stratums and the flows by specifying the placement in the `stat` argument. Adjusting the positioning can be very tricky and might require some trial and error, especially if you have modified the width of the different parts of the figure. Next, we define the color scale. We can choose to provide appropriate colors manually (`scale_fill_manual`) or use a predefined one from `ggplot2`. We can do additional aesthetics tweaks, such as changing the labels of the x-axis to Course 1, Course 2, Course 3, etc., switching the theme to `theme_void` to remove clutter in the figure, modify the legend position, and change the font size and color of the axis text.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(lodesclean, aes(x = x, stratum = stratum, alluvium = alluvium, y = Prop, fill = stratum)) +\n  geom_flow(width = 2/7, knot.prop = F, \n    curve_type = \"sine\", alpha = 0.25, aes.flow = \"backward\") + # Transitions\n  geom_stratum(width = .425, color = \"white\") + # Bars\n  geom_text(stat = \"stratum\", # Bar labels\n            aes(label = format(round(after_stat(prop), 2), nsmall = 2)), size = 3.5) +\n  geom_text(stat = \"flow\", # Transition labels   \n            aes(hjust = ifelse(after_stat(flow) == \"to\", 2.75, -1.85),\n                label = ifelse(is.na((alluvium)), \"\", \n                  format(round(after_stat(count)/1, 2), nsmall = 2))), \n            size = 2.5, vjust = \"inward\") +\n  scale_fill_manual(values = c(\"#007604\", \"#53b3cb\", \"#f9c22e\", \"#e01a4f\"), \"State\") +\n  scale_x_discrete(labels = paste0(\"Course \", 1:6)) +\n  theme_void() +\n  theme(legend.position = \"top\", axis.text.x = element_text(color=\"#000000\", size=10))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}